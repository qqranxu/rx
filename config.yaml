# Clash Meta 配置文件
# 新加坡阿里云节点配置
mixed-port: 7890
allow-lan: true
mode: rule
log-level: info
external-controller: 127.0.0.1:9090
unified-delay: true
global-client-fingerprint: chrome

dns:
  enable: true
  listen: :53
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  default-nameserver: 
    - 223.5.5.5
    - 8.8.8.8
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://1.1.1.1/dns-query
  fallback:
    - https://1.0.0.1/dns-query
    - tls://1.1.1.1

# 代理节点配置
proxies:
  # 香港节点 - 阿里云
  - name: "HK-Alibaba_Cloud"
    type: vless
    server: 8.218.245.137
    port: 58546
    uuid: ce9dd965-aeb6-4e79-8305-a8ebc22c5b73
    network: tcp
    tls: true
    flow: xtls-rprx-vision
    client-fingerprint: chrome
    servername: www.apple.com
    reality-opts:
      public-key: 2PWxkzwUdfAz_QjH693GaJDX4Az6GF5Zt1wK4K_wdxI
      short-id: feab74f8cd109a5d

  # 香港节点 - x-ui
  - name: "HK-x-ui"
    type: vless
    server: 8.218.245.137
    port: 37686
    uuid: b4fdcc63-c5d2-48ed-b9c1-42bc1c68f582
    network: tcp
    tls: true
    flow: xtls-rprx-vision
    client-fingerprint: chrome
    servername: www.yahoo.com
    reality-opts:
      public-key: Nl5Uq0Bb6ZjZr3o1oFpJZxTWshQg45VxnRVGfwEW60g
      short-id: 3fc52027

# 代理组配置
proxy-groups:
  # 主选择组
  - name: "🚀 节点选择"
    type: select
    proxies:
      - "♻️ 自动选择"
      - "🇭🇰 香港"
      - "HK-Alibaba_Cloud"
      - "HK-x-ui"
      - DIRECT

  # 自动选择组 - 基于延迟测试
  - name: "♻️ 自动选择"
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    proxies:
      - "HK-Alibaba_Cloud"
      - "HK-x-ui"
      - "HK-x-ui"

  # 香港节点组
  - name: "🇭🇰 香港"
    type: select
    proxies:
      - "HK-Alibaba_Cloud"

  # 流媒体选择
  - name: "📺 流媒体"
    type: select
    proxies:
      - "🇭🇰 香港"
      - "♻️ 自动选择"
      - "HK-Alibaba_Cloud"
      - "HK-x-ui"

  # 广告拦截
  - name: "🛑 广告拦截"
    type: select
    proxies:
      - REJECT
      - DIRECT

# 规则配置
rules:
  # 广告拦截
  - DOMAIN-SUFFIX,googlesyndication.com,🛑 广告拦截
  - DOMAIN-SUFFIX,doubleclick.net,🛑 广告拦截
  - DOMAIN-KEYWORD,adnxs,🛑 广告拦截
  - DOMAIN-KEYWORD,adsystem,🛑 广告拦截
  
  # 流媒体规则
  - DOMAIN-SUFFIX,netflix.com,📺 流媒体
  - DOMAIN-SUFFIX,nflximg.net,📺 流媒体
  - DOMAIN-SUFFIX,youtube.com,📺 流媒体
  - DOMAIN-SUFFIX,googlevideo.com,📺 流媒体
  
  # 国外常用服务
  - DOMAIN-SUFFIX,google.com,🚀 节点选择
  - DOMAIN-SUFFIX,googleapis.com,🚀 节点选择
  - DOMAIN-SUFFIX,facebook.com,🚀 节点选择
  - DOMAIN-SUFFIX,twitter.com,🚀 节点选择
  - DOMAIN-SUFFIX,telegram.org,🚀 节点选择
  - DOMAIN-SUFFIX,instagram.com,🚀 节点选择
  - DOMAIN-SUFFIX,openai.com,🚀 节点选择
  - DOMAIN-SUFFIX,github.com,🚀 节点选择
  
  # 中国IP和域名直连
  - GEOIP,CN,DIRECT
  
  # 最终规则
  - MATCH,🚀 节点选择
